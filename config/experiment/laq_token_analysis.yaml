# @package _global_

defaults:
  - /model@model: laq
  - /data@data: oxe_local_indexed
  - /training@training: laq_optimizer
  - /validation@validation: laq_local_rich
  - /cluster@cluster: local_dev
  - optional /user_config: local

experiment:
  name: laq_token_analysis
  description: "Offline LAQ action token generalization analysis"

seed: 42

model:
  image_size: 256
  use_dinov3_encoder: true
  dinov3_model_name: "facebook/dinov3-vits16-pretrain-lvd1689m"
  dinov3_pool_to_grid: 8
  code_seq_len: 4
  codebook_size: 8
  use_dino_decoder: true
  use_pixel_decoder: false
  use_aux_decoder: true
  codebook_replace_schedule: []
  flow:
    enabled: true
    model: raft_small
    loss_weight: 0.1
    decoder_depth: 2
    warmup_steps: 0
    teacher_num_flow_updates: 6
    teacher_chunk_size: 64

data:
  loader:
    batch_size: 32
    num_workers: 0

analysis:
  checkpoint_path: "/mnt/data/workspace/runs/hlrp/2026-02-02_10-58-35_laq_continue_with_flow/checkpoints/laq-stepstep=080000.ckpt"
  output_root: "output"
  samples_per_dataset: 3000
  max_batches: 5000
  visual_subset_size: 2000
  top_k_sequences: 12
  top_k_heatmap: 50
  top_k_transfer: 5
  top_k_transfer_tokens: 8
  inspected_tokens_k: 16
  top_k_token_reports: 6
  token_report_examples: 16
  token_report_targets_per_dataset: 2
  examples_per_sequence: 12
  min_samples_per_dataset: 10
  min_compass_samples: 20
  static_eps: 1.0e-6
  min_dataset_samples: 500

  run:
    analysis_1: true
    analysis_2: true
    analysis_3: true
    analysis_4: true
    analysis_5: true
    analysis_6: true
    analysis_7: true
    analysis_8: true

logging:
  level: INFO
  use_wandb: false
  tags: ["eval", "laq", "token-analysis"]
